<htmlform formUuid="06ad39ee-06c4-4179-9687-a6ffa5e2deb3" formName="Anthropometry" formEncounterType="01fc1f28-6ae5-4402-846a-40c0302eb1fd" formVersion="0.1"
    formAddMetadata="yes"
formUILocation="patientDashboard.overallActions"
formOrder="10"
formIcon="icon-random"
formShowIf=""
formDisplayStyle="Standard"
    >
    <!-- Autogenerated example form  (template from 01-Nov-2010 -->
    <macros>
        paperFormId = (Fill this in)
        headerColor =#009d8e
        fontOnHeaderColor = white
    </macros>

    <style>
        .section {
            border: 1px solid $headerColor;
            padding: 2px;
            text-align: left;
            margin-bottom: 1em;
        }
        .sectionHeader {
            background-color: $headerColor;
            color: $fontOnHeaderColor;
            display: block;
            padding: 2px;
            font-weight: bold;
        }
        table.baseline-aligned td {
            vertical-align: baseline;
        }
    </style>

    <span style="float:right">Paper Form ID: $paperFormId</span>
    <h2>Anthropometry (v0.1)</h2>

    <section headerLabel="1. Encounter Details">
        <table class="baseline-aligned">

            <tr>
                <td>Type:</td>
                <td><encounterType types="01fc1f28-6ae5-4402-846a-40c0302eb1fd" default="Anthropometry"/></td>
            </tr>
            <tr>
                <td>Date:</td>
                <td><encounterDate default="today"/></td>
            </tr>
            <tr>
                <td>Location:</td>
                <td><encounterLocation/></td>
            </tr>
            <tr>
                <td>Provider:</td>
                <td><encounterProvider/></td>
            </tr>
        </table>
    </section>

    <section headerLabel="2. Demographic Information">
        <table class="baseline-aligned">
            <tr>
                <td>Name:</td>
                <td><lookup class="value" expression="patient.personName"/></td>
            </tr>
            <tr>
                <td>OpenMRS ID:</td>
                <td><lookup class="value" complexExpression="#foreach( $patId in $patientIdentifiers.get('OpenMRS ID') ) $patId #end "/></td>
            </tr>
            <!--<tr>
                <td>Old Identification Number:</td>
                <td><lookup class="value" complexExpression="#foreach( $patId in $patientIdentifiers.get('Old Identification Number') ) $patId #end "/></td>
            </tr>
            <tr>
                <td>OpenMRS Identification Number:</td>
                <td><lookup class="value" complexExpression="#foreach( $patId in $patientIdentifiers.get('OpenMRS Identification Number') ) $patId #end "/></td>
            </tr>-->
            <tr>
                <td>Gender:</td>
                <td><lookup class="value" expression="patient.gender"/></td>
            </tr>
            <tr>
                <td>Birthdate:</td>
                <td>
                    <lookup class="value" complexExpression="#if( \$patient.birthdateEstimated ) ~#end"/> <lookup class="value" expression="patient.birthdate"/>
                    (Age: <lookup class="value" expression="patient.age"/>)
                </td>
            </tr>
            <!--<tr>
                <td>Health Center:</td>
                <td><lookup class="value" expression="personAttributes.get('Health Center')"/></td>
            </tr>
            <tr>
                <td>Health District:</td>
                <td><lookup class="value" expression="personAttributes.get('Health District')"/></td>
            </tr>-->
            <tr>
                <td>Telephone Number:</td>
                <td><lookup class="value" expression="personAttributes.get('Telephone Number')"/></td>
            </tr>
            <tr>
                <td>Occupation:</td>
                <td><lookup class="value" expression="personAttributes.get('Occupation')"/></td>
            </tr>
            <!--<tr>
                <td>Ethnicity:</td>
                <td><lookup class="value" expression="personAttributes.get('Ethnicity')"/></td>
            </tr>-->
            <tr>
                <td>Next of Kin:</td>
                <td><lookup class="value" expression="personAttributes.get('Next of Kin')"/></td>
            </tr>
            <tr>
                <td>Next of Kin's Phone Number:</td>
                <td><lookup class="value" expression="personAttributes.get('Next of Kins Phone Number')"/></td>
            </tr>
            <tr>
                <td>Date of First Encounter:</td>
                <td><lookup class="value" expression="personAttributes.get('Date of First Encounter')"/></td>
            </tr>
            <!--<tr>
                <td>Referral Source:</td>
                <td><lookup class="value" expression="personAttributes.get('Referral Source')"/></td>
            </tr>-->
            <tr>
                <td>Average Monthly Income:</td>
                <td><lookup class="value" expression="personAttributes.get('Average Monthly Income')"/></td>
            </tr>
        </table>
    </section>

    <!-- -  Haemodialysis patients

    -->
    <section headerLabel="3. Measurements">
        <table class="baseline-aligned" style="border: 1px solid lightgreen;">
            <tr>
                <td><h4><uimessage code="Weight (kg):"/></h4></td>
                <td><p><obs conceptId="163174" id="weight" /></p></td>
            </tr>
            <tr>
                <td><h4><uimessage code="Height (m):"/></h4></td>
                <td><p><obs conceptId="163159" id="height" /></p></td>
            </tr>
            <tr>
                <td><h4><uimessage code="BMI:"/></h4></td>
                <td><p><obs conceptId="163206" id="bmi" /></p></td>
            </tr>
            <tr>
                <td><h4><uimessage code="Waist Circumference:"/></h4></td>
                <td><p><obs conceptId="163207" id="waist_circ"/></p></td>
            </tr>
            <tr>
                <td><h4><uimessage code="Hip Circumference:"/></h4></td>
                <td><p><obs conceptId="163184" id="hip_circ" /></p></td>
            </tr>
            <tr>
                <td><h4><uimessage code="Waist-Hip Ratio:"/></h4></td>
                <td><p><obs conceptId="163183" id="waist_hip"/></p></td>
            </tr>
                        
        </table>
    </section>

    <submit/>

<!-- END OF FORM

Simple examples to copy-and-paste. Full reference at http://wiki.openmrs.org/x/kg8z

SECTION
    <section headerLabel="\#. Title">
        Content
    </section>

NUMERIC OBSERVATION
    <obs conceptId="id-of-numeric-concept" labelText="Label before"/>

DATE OBSERVATION
    <obs conceptId="id-of-date-concept" labelText="Label before"/>

CODED OBSERVATION
(as a dropdown)
    <obs conceptId="id-of-coded-concept" labelText="Label before"/>
(as radio buttons)
    <obs conceptId="id-of-coded-concept" labelText="Label before" style="radio"/>
(as an autocomplete)
    <obs conceptId="id-of-coded-concept" labelText="Label before" style="autocomplete" answerClasses="Diagnosis"/>
(as a checkbox for a specific answer)
    <obs conceptId="id-of-coded-concept" labelText="Label before" answerConceptId="id-of-answer-concept" answerLabel="label for answer"/>
(as a dropdown with specific choices)
    <obs conceptId="id-of-coded-concept" labelText="Label before" answerConceptIds="concept-id-1,concept-id-2,concept-id-3" answerLabels="Label 1,Label 2, Label 3"/>


FREE TEXT OBSERVATION
(as a normal text field)
    <obs conceptId="id-of-text-concept" labelText="Label before"/>
(as a textarea)
    <obs conceptId="id-of-text-concept" labelText="Label before" rows="4" cols="80"/>
-->

<script>
        // custom function written to calculate the BMI.

        jQuery(function(){


            //Section BMI

            jQuery('#bmi input').attr('disabled', 'disabled');

            jQuery('#height input').blur(calculateBMI);
            jQuery('#height input').keyup(calculateBMI);

            //Calculate Body Mass Index.
            function calculateBMI(){
                
                var weight = jQuery('#weight input').val();
                var height = jQuery('#height input').val();


                if ( !(weight == "" || height == "")){
                    var bmi = weight/(height * height);
                    jQuery('#bmi input').val(bmi);
                }
                else {

                    jQuery("#weight input").on('blur', function(){
                        
                        var weight = jQuery("#weight input").val();
                        var height = jQuery("#height input").val();
                        var bmi = weight/(height * height);
                        jQuery('#bmi input').val(bmi);
                    }).on('keyup', function(){
                        
                        var weight = jQuery("#weight input").val();
                        var height = jQuery("#height input").val();
                        var bmi = weight/(height * height);
                        jQuery('#bmi input').val(bmi);
                    });
                }
            }; 

            //|||||||||||||||||||||||||||||||||||||||||||||||||
            //||||||||||||||||||||||||||||||||||||||||||||||||

            //Section Waist-Hip

            jQuery('#waist_hip input').attr('disabled', 'disabled');

            jQuery('#hip_circ input').blur(calculateWHR);
            jQuery('#hip_circ input').keyup(calculateWHR);


            //Calculate Waist-Hip ratio.
            function calculateWHR(){
                
                var waist_circ = jQuery('#waist_circ input').val();
                var hip_circ = jQuery('#hip_circ input').val();


                if ( !(waist_circ == "" || hip_circ == "")){
                    var waist_hip = waist_circ/hip_circ;
                    jQuery('#waist_hip input').val(waist_hip);
                }
                else {

                    jQuery("#waist_circ input").on('blur', function(){
                        
                        var waist_circ = jQuery("#waist_circ input").val();
                        var hip_circ = jQuery("#hip_circ input").val();
                        var waist_hip = waist_circ/hip_circ;
                        jQuery('#waist_hip input').val(waist_hip);
                    }).on('keyup', function(){
                        
                        var waist_circ = jQuery("#waist_circ input").val();
                        var hip_circ = jQuery("#hip_circ input").val();
                        var waist_hip = waist_circ/hip_circ;
                        jQuery('#waist_hip input').val(waist_hip);
                    });
                }
            };


        });
    </script>

</htmlform>